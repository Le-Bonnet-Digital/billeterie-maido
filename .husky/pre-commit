#!/usr/bin/env sh
export PATH="$PWD/node_modules/.bin:$PATH"
BRANCH=$(git rev-parse --abbrev-ref HEAD)
if [ "$BRANCH" != "main" ]; then
  if ! git diff --cached --name-only | grep -q "^PO_NOTES.md$"; then
    echo "PO_NOTES.md must be updated and staged."
    exit 1
  fi
fi
if command -v git-secrets >/dev/null 2>&1; then
  git-secrets --scan
fi

npm run lint && npm test && lint-staged
